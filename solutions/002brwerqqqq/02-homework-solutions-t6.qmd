---
title: "Section 2 Homework Solutions"
format: 
  html:
    self-contained: true
execute:
  echo: false
  warning: false
  fig-height: 3
---

__Exercise 1__.

```{r}
library(tidyverse)
library(here)
stat113_df <- read_csv(here("data_private/stat113_survey_f25.csv"))

ggplot(data = stat113_df, aes(x = Exercise)) + 
  geom_histogram(colour = "darkorange4", fill = "darkorange1", bins = 10) +
  theme_minimal() +
  labs(x = "Exercise (hours per week)")
```

a. slightly right-skewed or approximately symmetric.

<!-- (or approximately symmetric would also get credit). -->

```{r}
sum_stats <- stat113_df |> pull(Exercise) |> summary() |>
  round(2)
```

b. approximately `r sum_stats["Median"]` hours.

c. approximately `r sum_stats["3rd Qu."] - sum_stats["1st Qu."]` hours.

d. approximately `r round(sd(stat113_df$Exercise, na.rm = TRUE), 2)` hours.

e. We would expect the mean to be slightly larger than the median if we said the distribution in (a) was right-skewed.

f. We would use the mean to describe the center and the standard deviation to describe the spread if we say there is no extreme skewness or outliers in the distribution of `Exercise`. (Or, we would use the median to describe the center and the IQR to describe the spread if we argue that the distribution is extremely skewed. There is no extreme skewness in this distribution though).

<br>

__Exercise 2__.

```{r}
ggplot(data = stat113_df, aes(x = Travel)) + 
  geom_histogram(colour = "darkslategray4", fill = "darkslategray1", bins = 15) +
  theme_minimal() +
  labs(x = "Travel Time to SLU (hours)")
```

a. right-skewed.

b. We would use the median to describe the center and the IQR to describe the spread of the distribution of `Travel` time because there is extreme right-skewness in the distribution of `Travel`.

c. The pollutant amounts for the the general vehicles should have a larger standard deviation because, if sampling a bunch of different vehicle types (trucks, sedans, etc.), the amount of pollution generated should be __more__ spread out/variable than the pollutants generated from a sampling of 50 of the same car model.

<br>

__Exercise 3__. 

```{r}
ggplot(data = stat113_df, aes(x = GPA)) + 
  geom_histogram(colour = "aquamarine4", fill = "aquamarine1", bins = 15) +
  theme_minimal() 

sum_stats_gpa <- stat113_df |> pull(GPA) |> summary() |>
  round(2)
```

a. left-skewed

b. approximately `r sum_stats_gpa["Median"]` points.

c. approximately `r sum_stats_gpa["3rd Qu."] - sum_stats_gpa["1st Qu."]` points.

d. approximately `r round(sd(stat113_df$GPA, na.rm = TRUE), 2)` points.

e. We would expect the mean GPA to be less than the median GPA because the distribution is left-skewed.

f. Can either say (1) we would use the mean to describe center and standard deviation to describe spread because, though there is some left-skewness in GPA, it is not extreme OR (2) we would use the median to describe center and IQR to describe spread because the distribution of GPA is extremely skewed.

g. Answers will vary but below is one example:

```{r}
fake_survey <- stat113_df |>
  mutate(fake_GPA = if_else(GPA <= 3.5,
                            GPA - 0.75,
                            false = GPA - 0.25))
ggplot(data = fake_survey, aes(x = fake_GPA)) +
  geom_histogram(colour = "black", fill = "white", bins = 15) +
  theme_minimal()
```

<br>

__Exercise 4__.

```{r}
gpa_vals <- c(1.0, 2.4, 2.5, 2.6, rep(3.0, 4), rep(3.2, 4), rep(3.4, 1), rep(3.6, 4),
  rep(3.75, 4), 4.0)
summary_gpa <- gpa_vals |> summary()
IQR <- summary_gpa["3rd Qu."] - summary_gpa["1st Qu."]
```

Lower Fence: `r summary_gpa["1st Qu."]` - `r 1.5 * IQR` = `r summary_gpa["1st Qu."] - 1.5 * IQR`.

Upper Fence: `r summary_gpa["3rd Qu."]` + `r 1.5 * IQR` = `r summary_gpa["3rd Qu."] + 1.5 * IQR`

Any value below the lower fence or above the upper fence should be considered an outlier in the boxplot. The lower whisker should extend to the smallest GPA value that is __not__ an outlier (2.4 in this case).

```{r}
gpa_df <- tibble::tibble(gpa_vals = gpa_vals)
ggplot(gpa_df, aes(y = gpa_vals)) +
  geom_boxplot(outlier.shape = 8, fill = "hotpink1", colour = "hotpink4") +
  ylab( "GPA") + xlab("") +
    scale_x_continuous(limits = c(-0.59, 0.59), labels = NULL) +
  theme(axis.ticks.x = element_blank()) +
  theme_minimal()
```

<br>

__Exercise 5__.

```{r, fig.height = 3, results = "hide"}
ggplot(data = stat113_df |> filter(!is.na(Sport) &
                                          !is.na(Hgt) & Sport != ""),
       aes(x = Sport, y = Hgt)) +
  geom_boxplot(outlier.shape = 8, fill = "hotpink1", colour = "hotpink4") +
  labs(y = "Height (inches)") +
  theme_minimal()
med_df <- stat113_df |> filter(!is.na(Sport)) |> group_by(Sport) |>
  summarise(med_height = median(Hgt, na.rm = TRUE))
```

a. Students who do not play a sport: `r med_df |> filter(Sport == "No") |> pull(med_height)` inches.

Students who do play a sport `r med_df |> filter(Sport == "Yes") |> pull(med_height)` inches.

b. Yes, height and sport do seem associated because the median height for students who do not play a sport is substantially different than the median height for students who do play a sport and there is not a ton of overlap in the distributions of height between the two groups.

<!-- OR  No, height and sport do not seem associated because the median heights for students who do and do not play sport are fairly similar and there is a lot of overlap in the distributions of height between the two groups. -->

<br>

__Exercise 6__. 

```{r, fig.height=3, results="hide"}
ggplot(data = stat113_df |> filter(!is.na(GPA) & !is.na(Award)),
       aes(x = Award, y = GPA)) +
  geom_boxplot(outlier.shape = 8, colour = "mediumpurple4", fill = "mediumpurple1") +
  labs(y = "GPA (points)") +
  theme_minimal()
```

a. Either (1) Yes, GPA and award do seem associated because the median gpas for students for each of the award types are similar there is not a ton of overlap in the distributions of height between the three groups OR 

(2) No, GPA and award do not seem associated because the median gpas for students for each of the three award types are fairly similar and there is a lot of overlap in the distributions of gpa between the three groups.

I would lean very slightly toward (1) for this example but either would receive full credit.

b. Plot that shows __more__ association:

```{r}
set.seed(4141231)
gpa_more_association <- c(rnorm(20, 2.0, 0.2),
                          rnorm(20, 2.5, 0.3),
                          rnorm(20, 3.5, 0.2))
gpa_less_association <- c(rnorm(60, 3.2, 0.4))
award <- c(rep("Academy", 20), rep("Nobel", 20), rep("Olympic", 20))
gpa_fake_association <- tibble::tibble(gpa_more_association, gpa_less_association, award)
ggplot(data = gpa_fake_association,
       aes(x = award, y = gpa_more_association)) +
  geom_boxplot(outlier.shape = 8, colour = "mediumpurple4", fill = "mediumpurple1") +
  theme_minimal()
```

Plot that shows __less__ association:

```{r}
ggplot(data = gpa_fake_association,
       aes(x = award, y = gpa_less_association)) +
  geom_boxplot(outlier.shape = 8, colour = "mediumpurple4", fill = "mediumpurple1") +
  theme_minimal()
```

<br>

